<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Procedimentos - Di√°rio da Rep√∫blica</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="header">
        <h1>Portal de Procedimentos</h1>
        <p>Di√°rio da Rep√∫blica - S√©rie II - Parte L</p>
        <div class="subtitle">Procedimentos de Contrata√ß√£o P√∫blica Ativos</div>
    </div>

    <div class="container">
        <div class="search-section">
            <h3 style="margin-bottom: 1.5rem; color: #2a5298; font-weight: 600;">üîç Pesquisar Procedimentos</h3>
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input"
                    placeholder="Pesquisar por entidade, descri√ß√£o, localiza√ß√£o, pre√ßo, prazo..."
                    onkeyup="filterProcedimentos()">
                <button class="search-btn" onclick="filterProcedimentos()">Pesquisar</button>
                <button class="clear-btn" onclick="clearSearch()">Limpar</button>
            </div>

            <div class="seed-search-container"
                style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e9ecef;">
                <h4 style="margin-bottom: 1rem; color: #2a5298; font-weight: 600;">üå± Pesquisar por Seed</h4>
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <input type="text" id="seedSearchInput" class="search-input"
                        placeholder="Digite o c√≥digo da seed (ex: SEED123456)" style="flex: 1; min-width: 250px;">
                    <button class="search-btn" onclick="searchBySeed()">Aplicar Seed</button>
                    <button class="clear-btn" onclick="showAvailableSeeds()">üîç Consultar Seeds</button>
                </div>
                <div style="margin-top: 0.5rem; font-size: 0.85rem; color: #6c757d;">
                    üí° Digite o c√≥digo da seed para filtrar procedimentos automaticamente
                </div>
            </div>
            <div class="search-info">
                <div>
                    <strong>üí° Dica:</strong> A pesquisa funciona em todos os campos: entidade, descri√ß√£o, localiza√ß√£o,
                    pre√ßo base, prazo de apresenta√ß√£o, NIPC, etc.
                </div>
                <button class="create-seed-btn" onclick="openSeedModal()">üå± Criar Seed</button>
            </div>
        </div>

        <!-- Modal para criar seeds -->
        <div id="seedModal" class="modal-overlay">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">üå± Criar Nova Seed</h3>
                    <button class="close-btn" onclick="closeSeedModal()">&times;</button>
                </div>

                <div class="seed-info">
                    <strong>Como usar:</strong> Digite palavras-chave separadas por v√≠rgulas ou pressione Enter para
                    criar tags individuais.
                    Estas seeds ser√£o usadas para filtrar procedimentos automaticamente.
                </div>

                <div class="seed-input-container">
                    <label for="districtSelect"
                        style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2c3e50;">üó∫Ô∏è
                        Distrito:</label>
                    <select id="districtSelect" class="seed-input" style="margin-bottom: 1rem;">
                        <option value="">Todos os distritos</option>
                        <option value="Aveiro">Aveiro</option>
                        <option value="Beja">Beja</option>
                        <option value="Braga">Braga</option>
                        <option value="Bragan√ßa">Bragan√ßa</option>
                        <option value="Castelo Branco">Castelo Branco</option>
                        <option value="Coimbra">Coimbra</option>
                        <option value="√âvora">√âvora</option>
                        <option value="Faro">Faro</option>
                        <option value="Guarda">Guarda</option>
                        <option value="Leiria">Leiria</option>
                        <option value="Lisboa">Lisboa</option>
                        <option value="Portalegre">Portalegre</option>
                        <option value="Porto">Porto</option>
                        <option value="Santar√©m">Santar√©m</option>
                        <option value="Set√∫bal">Set√∫bal</option>
                        <option value="Viana do Castelo">Viana do Castelo</option>
                        <option value="Vila Real">Vila Real</option>
                        <option value="Viseu">Viseu</option>
                        <option value="A√ßores">A√ßores</option>
                        <option value="Madeira">Madeira</option>
                    </select>

                    <label for="seedInput"
                        style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2c3e50;">üè∑Ô∏è
                        Palavras-chave (Global):</label>
                    <input type="text" id="seedInput" class="seed-input" placeholder="Ex: constru√ß√£o, inform√°tica..."
                        onkeydown="handleSeedInput(event, 'global')">
                    <div id="tagsContainer" class="tags-container" style="margin-bottom: 1rem;">
                        <!-- As tags ser√£o inseridas aqui dinamicamente -->
                    </div>

                    <label for="titleSeedInput"
                        style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: #2a5298;">üìå
                        Palavras-chave (T√≠tulo/Descri√ß√£o):</label>
                    <div style="font-size: 0.8rem; color: #666; margin-bottom: 0.5rem;">Estas palavras DEVEM aparecer
                        obrigatoriamente no t√≠tulo do procedimento.</div>
                    <input type="text" id="titleSeedInput" class="seed-input" placeholder="Ex: limpeza, software..."
                        onkeydown="handleSeedInput(event, 'title')">
                    <div id="titleTagsContainer" class="tags-container">
                        <!-- As tags de t√≠tulo ser√£o inseridas aqui dinamicamente -->
                    </div>
                </div>

                <div class="modal-actions">
                    <button class="cancel-btn" onclick="closeSeedModal()">Cancelar</button>
                    <button class="save-seed-btn" onclick="saveSeed()">Guardar Seed</button>
                </div>
            </div>
        </div>

        <!-- Filtro de seeds ativas -->
        <div id="seedFilter" class="seed-filter" style="display: none;">
            <h4>üîç Seeds Ativas:</h4>
            <div id="activeSeeds" class="active-seeds">
                <!-- Seeds ativas ser√£o inseridas aqui -->
            </div>
            <button class="clear-seeds-btn" onclick="clearActiveSeeds()" style="margin-top: 0.5rem;">Limpar
                Seeds</button>
        </div>

        <!-- Modal para mostrar seeds existentes -->
        <div id="seedsListModal" class="modal-overlay">
            <div class="modal" style="max-width: 700px;">
                <div class="modal-header">
                    <h3 class="modal-title">üå± Seeds Dispon√≠veis</h3>
                    <button class="close-btn" onclick="closeSeedsListModal()">&times;</button>
                </div>

                <div id="seedsListContainer" style="max-height: 400px; overflow-y: auto;">
                    <!-- Lista de seeds ser√° inserida aqui -->
                </div>

                <div class="modal-actions">
                    <button class="cancel-btn" onclick="closeSeedsListModal()">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="loading" class="loading">
        <h3>Carregando procedimentos...</h3>
        <p>Aguarde enquanto carregamos os dados mais recentes.</p>
    </div>

    <div id="error" class="error" style="display: none;">
        <h3>Erro ao carregar dados</h3>
        <p>N√£o foi poss√≠vel carregar os procedimentos. Verifique se o arquivo ativos.json existe.</p>
    </div>

    <div id="tableContainer" class="table-container" style="display: none;">
        <table class="procedures-table">
            <thead>
                <tr>
                    <th style="width: 50px;"></th>
                    <th class="sortable" data-sort="descricao">Descri√ß√£o</th>
                    <th class="sortable" data-sort="entidade">Entidade</th>
                    <th class="sortable" data-sort="plataforma">Plataforma</th>
                    <th class="sortable" data-sort="publicacao">Publica√ß√£o</th>
                    <th class="sortable" data-sort="prazo">Prazo</th>
                    <th class="sortable" data-sort="preco">Pre√ßo Base</th>
                </tr>
            </thead>
            <tbody id="proceduresTableBody">
                <!-- Os procedimentos ser√£o inseridos aqui dinamicamente -->
            </tbody>
        </table>
    </div>
    </div>

    <script src="scripts.js"></script>
</body>

</html>